(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[747],{7347:function(e){!function(){function t(e,t){document.addEventListener?e.addEventListener("scroll",t,!1):e.attachEvent("scroll",t)}function n(e){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(e)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function r(e,t){e.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+t+";"}function i(e){var t=e.a.offsetWidth,n=t+100;return e.f.style.width=n+"px",e.c.scrollLeft=n,e.b.scrollLeft=e.b.scrollWidth+100,e.g!==t&&(e.g=t,!0)}function s(e,n){function r(){i(s)&&s.a.parentNode&&n(s.g)}var s=e;t(e.b,r),t(e.c,r),i(e)}function a(e,t){var n=t||{};this.family=e,this.style=n.style||"normal",this.weight=n.weight||"normal",this.stretch=n.stretch||"normal"}var o=null,l=null,c=null,u=null;function d(){return null===u&&(u=!!document.fonts),u}function h(e,t){return[e.style,e.weight,!function(){if(null===c){var e=document.createElement("div");try{e.style.font="condensed 100px sans-serif"}catch(e){}c=""!==e.style.font}return c}()?"":e.stretch,"100px",t].join(" ")}a.prototype.load=function(e,t){var i=this,a=e||"BESbswy",c=0,u=t||3e3,g=(new Date).getTime();return new Promise(function(e,t){if(d()&&!function(){if(null===l){if(d()&&/Apple/.test(window.navigator.vendor)){var e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent);l=!!e&&603>parseInt(e[1],10)}else l=!1}return l}()){var m,f=new Promise(function(e,t){!function n(){(new Date).getTime()-g>=u?t(Error(""+u+"ms timeout exceeded")):document.fonts.load(h(i,'"'+i.family+'"'),a).then(function(t){1<=t.length?e():setTimeout(n,25)},t)}()});Promise.race([new Promise(function(e,t){c=setTimeout(function(){t(Error(""+u+"ms timeout exceeded"))},u)}),f]).then(function(){clearTimeout(c),e(i)},t)}else m=function(){function l(){var t;(t=-1!=p&&-1!=v||-1!=p&&-1!=x||-1!=v&&-1!=x)&&((t=p!=v&&p!=x&&v!=x)||(null===o&&(o=!!(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent))&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))),t=o&&(p==b&&v==b&&x==b||p==y&&v==y&&x==y||p==j&&v==j&&x==j)),t=!t),t&&(k.parentNode&&k.parentNode.removeChild(k),clearTimeout(c),e(i))}var d=new n(a),m=new n(a),f=new n(a),p=-1,v=-1,x=-1,b=-1,y=-1,j=-1,k=document.createElement("div");k.dir="ltr",r(d,h(i,"sans-serif")),r(m,h(i,"serif")),r(f,h(i,"monospace")),k.appendChild(d.a),k.appendChild(m.a),k.appendChild(f.a),document.body.appendChild(k),b=d.a.offsetWidth,y=m.a.offsetWidth,j=f.a.offsetWidth,function e(){if((new Date).getTime()-g>=u)k.parentNode&&k.parentNode.removeChild(k),t(Error(""+u+"ms timeout exceeded"));else{var n=document.hidden;(!0===n||void 0===n)&&(p=d.a.offsetWidth,v=m.a.offsetWidth,x=f.a.offsetWidth,l()),c=setTimeout(e,50)}}(),s(d,function(e){p=e,l()}),r(d,h(i,'"'+i.family+'",sans-serif')),s(m,function(e){v=e,l()}),r(m,h(i,'"'+i.family+'",serif')),s(f,function(e){x=e,l()}),r(f,h(i,'"'+i.family+'",monospace'))},document.body?m():document.addEventListener?document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e),m()}):document.attachEvent("onreadystatechange",function e(){("interactive"==document.readyState||"complete"==document.readyState)&&(document.detachEvent("onreadystatechange",e),m())})})},e.exports=a}()},120:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/vsrg-composer",function(){return n(8550)}])},5736:function(e,t,n){"use strict";n.d(t,{O:function(){return m}});var r=n(6042),i=n(5893),s=n(2169),a=[],o=[],l=!0,c=!1,u=void 0;try{for(var d,h=s.BX[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var g=d.value;g.startsWith("SFX")?o.push(g):a.push(g)}}catch(e){c=!0,u=e}finally{try{l||null==h.return||h.return()}finally{if(c)throw u}}function m(e){var t=e.selected,n=e.onChange,s=e.style;return(0,i.jsx)("select",{className:"select",style:(0,r.Z)({width:"100%",padding:"0.3rem"},s),onChange:function(e){return n(e.target.value)},value:t,children:0===o.length?(0,i.jsx)(i.Fragment,{children:a.map(function(e){return(0,i.jsx)("option",{value:e,children:e.replace("-"," ")},e)})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("optgroup",{label:"Instruments",children:a.map(function(e){return(0,i.jsx)("option",{value:e,children:e.replace("-"," ")},e)})}),(0,i.jsx)("optgroup",{label:"SFX",children:o.map(function(e){return(0,i.jsx)("option",{value:e,children:e.replace("-"," ").replace("SFX_","")},e)})})]})})}},6912:function(e,t,n){"use strict";n.d(t,{x:function(){return a}});var r=n(6042),i=n(5893),s=n(2169);function a(e){var t=e.selected,n=e.onChange,a=e.style,o=e.children,l=e.className;return(0,i.jsxs)("select",{className:"select ".concat(null!=l?l:""),style:(0,r.Z)({width:"100%",padding:"0.3rem"},a),onChange:function(e){return n(e.target.value)},value:t,children:[o,s.T_.map(function(e){return(0,i.jsx)("option",{children:e},e)})]})}},1709:function(e,t,n){"use strict";n.d(t,{P:function(){return o}});var r=n(6042),i=n(828),s=n(5893),a=n(5055);function o(e){var t=e.onChange,n=e.value,o=e.children,l=e.style,c=(0,i.Z)((0,a.F)(),1)[0];return(0,s.jsx)("select",{onChange:t,value:n,className:"select",style:(0,r.Z)({backgroundImage:"url(\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' height='24' viewBox='0 0 24 24' width='24' fill='".concat(c.getText("primary").hex().replace("#","%23"),"'><path d='M0 0h24v24H0z' fill='none'/><path d='M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z'/></svg>\")")},l),children:o})}},8550:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eK}});var r=n(4111),i=n(7568),s=n(1438),a=n(8668),o=n(6042),l=n(9396),c=n(6305),u=n(6626),d=n(655),h=n(5893),g=n(7294),m=n(828),f=n(8461),p=n(9878),v=n(781),x=n(125),b=n(7671),y=n(1866),j=n(750),k=n(1108),w=n(515),S=n(9218),C=n(1014),T=n(3805),H=n.n(T),O=n(5453),N=n(7053),P=n(4931),E=n(7008),z=n(5055),A=n(2132),_=n(1182),L=n(9583),R=n(2809),M=n(2650);function Z(e){var t=e.data,n=e.onChange,r=e.onVisibilityChange,i=e.theme,s=e.style,a=i.layer("menu_background",.2).desaturate(.5);return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"row-centered space-between track-modifier",style:(0,o.Z)({backgroundColor:a.hex()},s),children:[(0,h.jsx)("span",{className:"text-ellipsis",children:t.alias}),(0,h.jsxs)("div",{className:"row-centered",style:{justifyContent:"flex-end"},children:[(0,h.jsx)(f.J,{className:"flex-centered vsrg-track-modifier-button",onClick:function(){return r(!t.hidden)},children:t.hidden?(0,h.jsx)(L.tgn,{}):(0,h.jsx)(L.dSq,{})}),(0,h.jsx)(f.J,{className:"flex-centered vsrg-track-modifier-button",style:{marginLeft:"0.3rem"},onClick:function(){return n(t.set({muted:!t.muted}))},children:t.muted?(0,h.jsx)(L.xZH,{}):(0,h.jsx)(L.rxG,{})})]})]})})}var I={src:"/_next/static/media/help-vsrg-composer.60185841.png",height:757,width:1360,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAECAIAAAA8r+mnAAAAbElEQVR42mMI9I/xiUwO8I0KdQ8J8wj18gwLj88sqKhh8A6Odw+KDg6Oy8otzcgr9Q2KtXL2d/IJZ/D0jXELiXbzDnfzjvDwjXT2DPf2DwwK8mYIiE31DU/08I908Ql1dw+0cgjoaCheMq0SAE28IKrWqk93AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:4},D=n(9714),F=n(5675),B=n.n(F),W=n(8826);function K(){var e=D.z.getVsrgKeybinds(6);return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"column",children:[(0,h.jsxs)("div",{className:"column",style:{padding:"0.4rem"},children:[(0,h.jsx)("h2",{style:{margin:0},children:"Vsrg Composer info"}),(0,h.jsx)("p",{style:{marginLeft:"0.4rem"},children:"This is a composer to create beatmaps for the songs you have in the app. Here are explained how the composer works and how to use it."}),(0,h.jsx)("h2",{style:{margin:0},children:"How to use"}),(0,h.jsxs)("p",{style:{marginLeft:"0.4rem"},children:['You start off by selecting the song you want to create a beatmap for, you can find it in the Settings as "background song", you can mute and hide the layers of the song, the shown layers will have the notes appear in the timeline above the composer.',(0,h.jsx)("br",{}),(0,h.jsx)("br",{}),"Then you can select the bpm of the beatmap, usually it should be the same of the song or /2 or /4 of it. You can then select the different snap points, it's where the notes will be placed when you click on the editor. Then you can add notes to the editor by clicking them or using the keyboard. Once finished you can test the song in the vsrg player"]})]}),(0,h.jsx)(B(),{src:I,alt:"tutorial for the vsrg composer page",className:"help-img",loading:"lazy"}),(0,h.jsxs)("ol",{children:[(0,h.jsx)("li",{children:"Selected hit object"}),(0,h.jsx)("li",{children:"Held hit object"}),(0,h.jsx)("li",{children:"Background song notes"}),(0,h.jsx)("li",{children:"Instruments"}),(0,h.jsx)("li",{children:"Selected hit object's notes"}),(0,h.jsx)("li",{children:"Hit object type"}),(0,h.jsx)("li",{children:"Horizontal scaling"}),(0,h.jsx)("li",{children:"Slow down / Speed up the playback"}),(0,h.jsx)("li",{children:"BPM Snap points"}),(0,h.jsx)("li",{children:"Current timestamp in the timeline"}),(0,h.jsx)("li",{children:"Add/Remove breakpoint"})]}),(0,h.jsx)("div",{style:{marginBottom:"0.5rem"},children:"The main page has shortcuts for PC users:"}),(0,h.jsx)("table",{className:"keys-table",children:(0,h.jsxs)("tbody",{children:[(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:(0,h.jsx)(W.s,{children:"Space"})}),(0,h.jsx)("td",{children:" toggle playback "})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:(0,h.jsx)(W.s,{children:"Arrow Left/Right"})}),(0,h.jsx)("td",{children:"Move to Previous/Next breakpoint"})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:(0,h.jsx)(W.s,{children:"Arrow Up/Down"})}),(0,h.jsx)("td",{children:"Select instrument"})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:(0,h.jsx)(W.s,{children:e.join("/")})}),(0,h.jsx)("td",{children:"Add hit object (syncs to the registered keybinds)"})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:(0,h.jsx)(W.s,{children:"1/2/3"})}),(0,h.jsx)("td",{children:"Select tap/hold/delete"})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:(0,h.jsx)(W.s,{children:"Shift + W/A/S/D"})}),(0,h.jsx)("td",{children:"Move the selected hit object up / left / down / right, inverts if the editor is horizontal"})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:(0,h.jsx)(W.s,{children:"Esc"})}),(0,h.jsx)("td",{children:" Deselect current hitObject "})]})]})})]})})}var J=n(4339),U=H()(),V=(0,g.memo)(function(e){var t=e.onSave,n=e.onSongOpen,r=e.settings,i=e.handleSettingChange,s=e.hasChanges,a=e.onCreateSong,o=e.setAudioSong,l=e.audioSong,c=e.trackModifiers,u=e.onTrackModifierChange,d=(0,m.Z)((0,g.useState)(!1),2),j=d[0],k=d[1],C=(0,m.Z)((0,g.useState)(!1),2),T=C[0],H=C[1],A=(0,m.Z)((0,g.useState)("Settings"),2),_=A[0],M=A[1],I=(0,m.Z)((0,P.j)(),1)[0],D=(0,m.Z)((0,E.n)(),1)[0],F=(0,m.Z)((0,z.F)(),1)[0],B=(0,N.ZP)(function(e){k(!1),U&&H(!1)},{active:j&&T,ignoreFocusable:!0}),W=(0,g.useCallback)(function(e){"boolean"!=typeof e&&(e=void 0),H(function(t){return void 0!==e?e:!t})},[]),J=(0,g.useCallback)(function(e){if(e===_&&j)return k(!1);k(!0),e&&(M(e),O.Z.UIEvent("menu",{tab:e}))},[j,_]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"hamburger vsrg-hamburger",onClick:function(){return H(!T)},children:(0,h.jsx)(S.Z,{children:(0,h.jsx)(L.Fm7,{})})}),(0,h.jsxs)("div",{className:"menu-wrapper",ref:B,children:[(0,h.jsxs)("div",{className:T?"menu menu-visible":"menu",children:[(0,h.jsx)(b.s,{onClick:function(){return W(!1)},className:"close-menu",ariaLabel:"Close menu",children:(0,h.jsx)(L.aHS,{className:"icon"})}),(0,h.jsx)(b.s,{onClick:t,className:"margin-top-auto ".concat(s?"not-saved":""),ariaLabel:"Save",children:(0,h.jsx)(S.Z,{children:(0,h.jsx)(L.TvB,{className:"icon"})})}),(0,h.jsx)(b.s,{onClick:function(){return J("Help")},isActive:j&&"Help"===_,ariaLabel:"Help",children:(0,h.jsx)(S.Z,{children:(0,h.jsx)(L.LL$,{className:"icon"})})}),(0,h.jsx)(b.s,{onClick:function(){return J("Songs")},isActive:j&&"Songs"===_,ariaLabel:"Song menu",children:(0,h.jsx)(S.Z,{children:(0,h.jsx)(L.HcQ,{className:"icon"})})}),(0,h.jsx)(b.s,{onClick:function(){return J("Settings")},isActive:j&&"Settings"===_,ariaLabel:"Settings menu",children:(0,h.jsx)(S.Z,{children:(0,h.jsx)(L.p4t,{className:"icon"})})}),(0,h.jsx)(b.s,{onClick:function(){return R.I.open()},ariaLabel:"Open home menu",children:(0,h.jsx)(S.Z,{children:(0,h.jsx)(L.xng,{className:"icon"})})})]}),(0,h.jsxs)("div",{className:j&&T?"side-menu menu-open":"side-menu",children:[(0,h.jsx)(v.Z,{current:_,id:"Help",children:(0,h.jsx)(K,{})}),(0,h.jsxs)(v.Z,{current:_,id:"Songs",children:[(0,h.jsx)("div",{className:"row",children:(0,h.jsx)(f.J,{onClick:a,children:"Create song"})}),(0,h.jsx)(x.G,{songs:D,exclude:["composed","recorded"],style:{marginTop:"0.6rem"},SongComponent:q,componentProps:{theme:F,folders:I,functions:{onClick:n,toggleMenu:W}}})]}),(0,h.jsxs)(v.Z,{current:_,id:"Settings",children:[(0,h.jsx)(y.A,{settings:r,onUpdate:i}),(0,h.jsxs)("div",{className:"column vsrg-select-song-wrapper",children:[(0,h.jsxs)("h1",{className:"settings-group-title row-centered",children:["Background Song",(0,h.jsx)(w.k,{buttonStyle:{width:"1.2rem",height:"1.2rem",marginLeft:"0.5rem"},children:"You can select one of your songs to be played on the background"})]}),null===l?(0,h.jsx)("span",{children:"No background song selected"}):(0,h.jsxs)("div",{className:"column vsrg-composer-selected-song",children:[(0,h.jsxs)("div",{className:"row",style:{borderBottom:"2px solid var(--secondary)",paddingBottom:"0.4rem",marginBottom:"0.4rem"},children:[(0,h.jsx)("span",{className:"song-name",style:{cursor:"default"},children:l.name}),(0,h.jsx)(p.v,{onClick:function(){return o(null)},ariaLabel:"Remove background song",tooltip:"Remove background song",style:{backgroundColor:"var(--red-bg)",margin:0},children:(0,h.jsx)(L.aHS,{})})]}),(0,h.jsxs)("div",{className:"row-centered space-between",children:[(0,h.jsx)("span",{children:"Pitch"}),(0,h.jsx)("span",{children:l.pitch})]}),(0,h.jsxs)("div",{className:"row-centered space-between",children:[(0,h.jsx)("span",{children:"BPM"}),(0,h.jsx)("span",{children:l.bpm})]}),(0,h.jsx)("span",{style:{marginTop:"0.4rem"},children:"Instrument modifiers"}),c.map(function(e,t){return(0,h.jsx)(Z,{theme:F,data:e,onChange:function(e){return u(e,t,!1)},onVisibilityChange:function(n){u(e.set({hidden:n}),t,!0)}},t)})]}),(0,h.jsx)(x.G,{songs:D,exclude:["vsrg"],style:{marginTop:"0.6rem"},SongComponent:$,componentProps:{onClick:o}})]})]})]})]})]})},function(e,t){return e.settings===t.settings&&e.hasChanges===t.hasChanges&&e.audioSong===t.audioSong&&e.trackModifiers===t.trackModifiers});function $(e){var t=e.data,n=e.onClick;return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"song-row ".concat((0,C.h)(!0)),onClick:(0,i.Z)(function(){var e;return(0,d.__generator)(this,function(r){switch(r.label){case 0:return[4,_.v.getOneSerializedFromStorable(t)];case 1:if(!(e=r.sent()))return[2,J.kg.error("Could not find song")];return n(e),[2]}})}),style:{cursor:"pointer"},children:[(0,h.jsx)("div",{className:"song-name",children:t.name}),(0,h.jsx)(C.u,{children:"Click to select as background song"})]})})}function q(e){var t,n=e.data,r=e.functions,s=e.theme,a=e.folders,o=r.toggleMenu,l=r.onClick,c={backgroundColor:s.layer("primary",.15).hex()},u=(0,m.Z)((0,g.useState)(!1),2),f=u[0],p=u[1],v=(0,m.Z)((0,g.useState)(n.name),2),x=v[0],b=v[1];return((0,g.useEffect)(function(){b(n.name)},[n.name]),"vsrg"!==n.type)?(0,h.jsx)("div",{className:"row",children:"Invalid song"}):(0,h.jsxs)("div",{className:"song-row",children:[(0,h.jsxs)("div",{className:"song-name ".concat((0,C.h)(!0)),onClick:(0,i.Z)(function(){var e;return(0,d.__generator)(this,function(t){switch(t.label){case 0:if(f)return[2];return[4,_.v.fromStorableSong(n)];case 1:if(!(e=t.sent()))return[2,J.kg.error("Could not find song")];return l(e),o(!1),[2]}})}),children:[f?(0,h.jsx)("input",{className:"song-name-input ".concat(f?"song-rename":""),disabled:!f,onChange:function(e){return b(e.target.value)},style:{width:"100%",color:"var(--primary-text)"},value:x}):(0,h.jsx)("div",{style:{marginLeft:"0.3rem"},children:x}),(0,h.jsx)(C.u,{children:f?"Song name":"Play song"})]}),(0,h.jsx)("div",{className:"song-buttons-wrapper",children:(0,h.jsxs)(k.Rk,{Icon:L.LCi,style:c,ignoreClickOutside:f,tooltip:"More options",onClose:function(){return p(!1)},children:[(0,h.jsxs)(k.tc,{onClick:function(){f&&(M.k.renameSong(n.id,x),p(!1)),p(!f)},children:[(0,h.jsx)(L.tU3,{style:{marginRight:"0.4rem"},size:14}),(0,h.jsx)(k.Qr,{text:f?"Save":"Rename"})]}),(0,h.jsxs)(k.tc,{style:{padding:"0 0.4rem"},children:[(0,h.jsx)(L.$nz,{style:{marginRight:"0.4rem"}}),(0,h.jsxs)("select",{className:"dropdown-select",value:n.folderId||"_None",onChange:(t=(0,i.Z)(function(e){var t,r;return(0,d.__generator)(this,function(i){switch(i.label){case 0:return t=e.target.value,[4,_.v.getOneSerializedFromStorable(n)];case 1:if(!(r=i.sent()))return[2,J.kg.error("Could not find song")];return M.k.addSongToFolder(r,"_None"!==t?t:null),[2]}})}),function(e){return t.apply(this,arguments)}),children:[(0,h.jsx)("option",{value:"_None",children:"None"}),a.map(function(e){return(0,h.jsx)("option",{value:e.id,children:e.name},e.id)})]})]}),(0,h.jsxs)(k.tc,{onClick:(0,i.Z)(function(){var e;return(0,d.__generator)(this,function(t){switch(t.label){case 0:return[4,_.v.getOneSerializedFromStorable(n)];case 1:if(!(e=t.sent()))return[2,J.kg.error("Could not find song")];return A.bV.downloadSong(e,n.name),[2]}})}),children:[(0,h.jsx)(L.aBF,{style:{marginRight:"0.4rem"},size:14}),(0,h.jsx)(k.Qr,{text:"Download"})]}),(0,h.jsxs)(k.tc,{onClick:(0,i.Z)(function(){return(0,d.__generator)(this,function(e){switch(e.label){case 0:return[4,(0,j.jH)("Are you sure you want to delete this song?")];case 1:if(!e.sent())return[2];return M.k.removeSong(n.id),[2]}})}),children:[(0,h.jsx)(L.Xm5,{color:"#ed4557",style:{marginRight:"0.4rem"},size:14}),(0,h.jsx)(k.Qr,{text:"Delete"})]})]})})]})}var X=n(2169),Y=n(1709),Q=n(6743);function G(e){var t=e.options,n=e.selected,r=e.onChange,i=(0,g.useRef)(null),s=t.find(function(e){return e.value===n}),a=(0,m.Z)((0,g.useState)({width:0,left:0}),2),o=a[0],l=a[1];return(0,g.useEffect)(function(){var e,r=null===(e=i.current)||void 0===e?void 0:e.querySelectorAll("button"),s=t.findIndex(function(e){return e.value===n});if(r&&!(s<0)){var a=r[s].getBoundingClientRect(),o=i.current.getBoundingClientRect();l({width:a.width,left:a.left-o.left})}},[i,t,n]),(0,h.jsxs)("div",{className:"multiple-option-slider",ref:i,children:[t.map(function(e){return(0,h.jsx)("button",{onClick:function(){return r(e.value)},className:e===s?"multiple-options-selected":"",children:(0,Q.kC)(e.value)},e.value)}),(0,h.jsx)("div",{className:"multiple-option-slider-overlay",style:{width:"".concat(o.width,"px"),left:"".concat(o.left,"px"),backgroundColor:null==s?void 0:s.color}})]})}var ee=[{value:"tap",color:"var(--accent)"},{value:"hold",color:"#8569a9"},{value:"delete",color:"var(--red)"}],et=[1,2,4,8,16];function en(e){var t=e.onSnapPointChange,n=e.onHitObjectTypeChange,r=e.selectedSnapPoint,i=e.isPlaying,s=e.togglePlay,a=e.selectedHitObjectType,o=e.vsrg,l=e.onScalingChange,c=e.scaling,u=e.tempoChanger,d=e.onTempoChangerChange;return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"vsrg-bottom",children:[(0,h.jsx)(G,{options:ee,selected:a,onChange:function(e){n(e)}}),(0,h.jsx)("div",{className:"vsrg-name text-ellipsis",children:o.name}),(0,h.jsx)("div",{className:"flex-centered",style:{flex:"1",padding:"0 1rem"},children:(0,h.jsx)("input",{type:"range",min:10,style:{width:"100%"},max:120,value:c,onPointerUp:function(e){var t;null===(t=e.target)||void 0===t||t.blur()},onChange:function(e){return l(parseInt(e.target.value))}})}),(0,h.jsxs)("div",{className:"flex-centered",style:{height:"100%"},children:[(0,h.jsx)(Y.P,{value:u,onChange:function(e){return d(Number(e.target.value))},style:{width:"5rem",height:"100%",borderRadius:"0.4rem",marginRight:"0.6rem"},children:X.zr.map(function(e){return(0,h.jsxs)("option",{value:e,children:[100*e,"%"]},e)})}),(0,h.jsx)(Y.P,{value:r,onChange:function(e){t(parseInt(e.target.value))},style:{width:"6rem",height:"100%",borderRadius:"0.4rem"},children:et.map(function(e){return(0,h.jsxs)("option",{value:e,children:["Snap: 1/",e]},e)})}),(0,h.jsx)(f.J,{className:"vsrg-play-button flex-centered",onClick:s,children:i?(0,h.jsx)(L.Wh,{size:20}):(0,h.jsx)(L.gmG,{size:20})})]})]})})}var er=n(6767),ei=n.n(er);function es(e){var t=e.elements,n=e.perRow,r=e.onClick,i=e.selected;return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",{className:"vsrg-keyboard",style:{gridTemplateColumns:"repeat(".concat(n,", 1fr)"),gridTemplateRows:"repeat(".concat(Math.ceil(t.length/n),", 1fr)"),opacity:i?1:.5,pointerEvents:i?"all":"none",cursor:i?"pointer":"not-allowed"},children:t.map(function(e){return(0,h.jsx)("button",{onClick:function(){return r(e)},style:(null==i?void 0:i.includes(e))?{backgroundColor:"var(--accent)"}:{}},e)})})})}var ea=n(5736),eo=n(6912),el=n(5651);function ec(e){var t=e.onChange,n=e.value,r=e.absolute,i=e.style,s=function(e){c(ei()(e))},a=(0,m.Z)((0,g.useState)(ei()(n)),2),l=a[0],c=a[1];return(0,g.useEffect)(function(){c(ei()(n))},[n]),(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"color-picker",style:(0,o.Z)({position:void 0===r||r?"absolute":"unset"},i),children:[(0,h.jsx)(el.gW,{onChange:s,color:l.hex()}),(0,h.jsxs)("div",{className:"color-picker-row",children:[(0,h.jsxs)("div",{className:"color-picker-input",style:{backgroundColor:l.toString(),color:l.isDark()?X.kx.text.light:X.kx.text.dark},children:[(0,h.jsx)("div",{style:{fontFamily:"Arial"},children:"#"}),(0,h.jsx)(el.ZE,{onChange:s,color:l.hex(),style:{color:l.isDark()?X.kx.text.light:X.kx.text.dark}})]}),(0,h.jsx)("button",{className:"color-picker-check",onClick:function(){c(ei()(n)),null==t||t(n)},style:{backgroundColor:l.toString(),color:l.isDark()?X.kx.text.light:X.kx.text.dark},children:(0,h.jsx)(L.aHS,{size:16})}),(0,h.jsx)("button",{className:"color-picker-check",onClick:function(){null==t||t(l.toString())},style:{backgroundColor:l.toString(),color:l.isDark()?X.kx.text.light:X.kx.text.dark},children:(0,h.jsx)(L.l_A,{size:16})})]})]})})}var eu=new(function(){function e(){(0,s.Z)(this,e),this.listeners=new Map}var t=e.prototype;return t.addEventListener=function(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)},t.removeEventListener=function(e,t){var n=this.listeners.get(e);if(n){var r=n.findIndex(function(e){return e.id===t.id||e.callback===t.callback});-1!==r&&n.splice(r,1)}},t.emitEvent=function(e,t){var n,r;(0,c.Z)(null!==(n=this.listeners.get(e))&&void 0!==n?n:[]).concat((0,c.Z)(null!==(r=this.listeners.get("ALL"))&&void 0!==r?r:[])).forEach(function(n){return n.callback(e,t)})},e}());function ed(e){var t=e.track,n=e.onSave,r=e.onDelete,i=e.onChange,s=(0,m.Z)((0,g.useState)(!1),2),a=s[0],l=s[1];return t?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"vsrg-floating-settings box-shadow",children:[(0,h.jsxs)("div",{className:"row-centered space-between",children:["Track name",(0,h.jsx)("input",{type:"text",maxLength:50,className:"input",style:{width:"7.4rem"},value:t.instrument.alias,onChange:function(e){t.instrument.set({alias:e.target.value}),i(t)},placeholder:t.instrument.name})]}),(0,h.jsxs)("div",{className:"row-centered space-between",style:{marginTop:"0.4rem"},children:["Instrument",(0,h.jsx)(ea.O,{style:{width:"8rem"},selected:t.instrument.name,onChange:function(e){t.instrument.set({name:e}),i(t)}})]}),(0,h.jsxs)("div",{className:"row-centered space-between",style:{marginTop:"0.4rem"},children:["Pitch",(0,h.jsx)(eo.x,{style:{width:"8rem"},selected:t.instrument.pitch,onChange:function(e){t.instrument.set({pitch:e}),i(t)},children:(0,h.jsx)("option",{value:"",children:"Use song pitch"})})]}),(0,h.jsxs)("div",{className:"row-centered",style:{marginTop:"1rem",alignItems:"center"},children:["Volume",(0,h.jsxs)("span",{style:(0,o.Z)({marginLeft:"0.4rem",width:"3rem"},t.instrument.volume>100&&{color:"hsl(0, ".concat(-40+t.instrument.volume,"%, 61%)"),marginLeft:"0.4rem"}),children:[t.instrument.volume,"%"]}),(0,h.jsx)(w.k,{buttonStyle:{width:"1.2rem",height:"1.2rem"},width:10,children:"If you hear distortion, reduce the volume"})]}),(0,h.jsx)("div",{className:"row-centered",children:(0,h.jsx)("input",{type:"range",style:{flex:"1"},min:0,max:125,value:t.instrument.volume,onChange:function(e){t.instrument.set({volume:parseInt(e.target.value)}),i(t)}})}),(0,h.jsx)("div",{className:"column",children:(0,h.jsxs)("div",{className:"row-centered space-between",children:["Color",(0,h.jsx)(f.J,{onClick:function(){return l(!0)},ariaLabel:"Change color",style:{backgroundColor:t.color,color:ei()(t.color).isDark()?"#fff":"#000"},children:"Change"})]})}),(0,h.jsxs)("div",{className:"row space-between",style:{marginTop:"0.4rem"},children:[(0,h.jsxs)(f.J,{className:"row-centered",style:{padding:"0.4rem",width:"fit-content"},onClick:r,children:[(0,h.jsx)(L.Xm5,{color:"var(--red)",style:{marginRight:"0.3rem"}}),"Delete"]}),(0,h.jsx)(f.J,{onClick:n,style:{padding:"0.4rem",width:"fit-content"},children:"Ok"})]})]}),a&&(0,h.jsx)(ec,{style:{right:"0.8rem",top:"0.5rem"},value:t.color,onChange:function(e){i(t.set({color:e})),l(!1),eu.emitEvent("colorChange")}})]}):null}function eh(e){var t=e.vsrg,n=e.selectedTrack,r=e.children,i=e.onTrackAdd,s=e.onTrackChange,a=e.onTrackSelect,o=e.onTrackDelete,l=e.onNoteSelect,c=e.onBreakpointChange,u=e.onBreakpointSelect,d=e.lastCreatedHitObject,p=e.selectedHitObject,v=(0,m.Z)((0,z.F)(),1)[0],x=(0,m.Z)((0,g.useState)([]),2),b=x[0],y=x[1],j=(0,m.Z)((0,g.useState)(!1),2),k=j[0],w=j[1],C=t.tracks[n];return(0,g.useEffect)(function(){y(Array("Sky"===X.iC?15:21).fill(0).map(function(e,t){return t}))},[]),(0,h.jsxs)(h.Fragment,{children:[r,(0,h.jsxs)("div",{className:"vsrg-top-right ".concat(null!==d?"vsrg-top-right-disabled":""),children:[k&&(0,h.jsx)(ed,{track:C,onSave:function(){return w(!1)},onDelete:function(){return o(n)},onChange:function(e){return s(e,n)}}),(0,h.jsxs)("div",{className:"row-centered vsrg-breakpoints-buttons",style:{marginBottom:"0.4rem"},children:[(0,h.jsx)(f.J,{style:{marginLeft:0},onClick:function(){return u(-1)},children:(0,h.jsx)(S.Z,{children:(0,h.jsx)(L.qSR,{})})}),(0,h.jsx)(f.J,{onClick:function(){return c(!0)},children:(0,h.jsx)(S.Z,{children:(0,h.jsx)(L.iFH,{})})}),(0,h.jsx)(f.J,{onClick:function(){return c(!1)},children:(0,h.jsx)(S.Z,{children:(0,h.jsx)(L.wEH,{})})}),(0,h.jsx)(f.J,{onClick:function(){return u(1)},children:(0,h.jsx)(S.Z,{children:(0,h.jsx)(L.Nqc,{})})})]}),(0,h.jsxs)("div",{className:"vsrg-track-wrapper column",children:[t.tracks.map(function(e,t){return(0,h.jsx)(eg,{track:e,selected:t===n,theme:v,onSettingsClick:function(){return w(!k)},onTrackClick:function(){return a(t)}},t)}),(0,h.jsx)("div",{style:{width:"100%",height:"1.4rem"}}),(0,h.jsx)(f.J,{onClick:function(e){setTimeout(function(){var t;i(),null===(t=e.target)||void 0===t||t.scrollIntoView()},50)},ariaLabel:"Add new instrument",className:"flex-centered",style:{marginTop:"auto",padding:"0.3rem"},children:(0,h.jsx)(L.wEH,{size:16,color:"var(--icon-color)"})})]}),(0,h.jsx)(es,{elements:b,selected:null==p?void 0:p.notes,perRow:"Sky"===X.iC?5:7,onClick:l})]})]})}function eg(e){var t=e.track,n=e.selected,r=e.theme,i=e.onSettingsClick,s=e.onTrackClick,a=(0,m.Z)((0,g.useState)({background:"var(--primary)",text:"var(--primary-text)"}),2),o=a[0],l=a[1],c=(0,m.Z)((0,g.useState)({background:"var(--primary)",text:"var(--primary-text)"}),2),u=c[0],d=c[1];return(0,g.useEffect)(function(){var e=r.get("primary").mix(new(ei())(t.color),.3);l({background:e.toString(),text:e.isDark()?"var(--text-light)":"var(--text-dark)"});var n=new(ei())(t.color);d({background:n.toString(),text:n.isDark()?"rgb(220 219 216)":"rgb(55 55 55)"})},[r,t.color]),(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"vsrg-track row-centered",style:{backgroundColor:n?o.background:"var(--primary)",color:n?o.text:"var(--primary-text)"},onClick:s,children:[(0,h.jsx)("span",{className:"text-ellipsis",style:{color:n?o.text:"var(--text-color)",paddingLeft:"0.6rem",paddingRight:"0.2rem",flex:1},children:t.instrument.alias||t.instrument.name}),(0,h.jsx)(f.J,{onClick:function(){return n&&i()},style:{backgroundColor:u.background},className:"vsrg-track-left flex-centered",children:n&&(0,h.jsx)(L.p4t,{color:u.text})})]})})}var em=n(5623),ef=n(8810),ep=n(8010),ev=n(3564),ex=n(7564),eb=n(3531);ex.Xd.LINE_SCALE_MODE=ex.F4.NORMAL;var ey=function(){function e(t){var n=t.app,r=t.colors,i=t.sizes,a=t.trackColors,o=t.isHorizontal,l=this;(0,s.Z)(this,e),this.destroy=function(){var e,t,n,r;null===(e=l.textures.snapPoints.small)||void 0===e||e.destroy(),null===(t=l.textures.snapPoints.large)||void 0===t||t.destroy(),null===(n=l.textures.snapPoints.empty)||void 0===n||n.destroy(),Object.values(l.textures.hitObjects).forEach(function(e){return null==e?void 0:e.destroy()}),Object.values(l.textures.heldHitObjects).forEach(function(e){return null==e?void 0:e.destroy()}),Object.values(l.textures.trails).forEach(function(e){return null==e?void 0:e.destroy()}),Object.values(l.textures.selectionRings).forEach(function(e){return null==e?void 0:e.destroy()}),Object.values(l.textures.timeline).forEach(function(e){return null==e?void 0:e.destroy()}),null===(r=l.textures.buttons.time)||void 0===r||r.destroy(),l.app=null},this.textures={hitObjects:{},heldHitObjects:{},selectionRings:{},trails:{},buttons:{width:0,height:0,time:null},snapPoints:{size:0,small:null,large:null,empty:null},timeline:{breakpoint:null,currentTime:null,note:null,square:null,thumb:null},sizes:{hitObject:0,trail:0}},this.trackColors=a,this.colors=r,this.isHorizontal=o,this.sizes=i,this.app=n,this.generate()}var t=e.prototype;return t.generate=function(){var e=this.app;e&&(this.generateSnapPoints(e),this.generateTrackCache(e),this.generateTrails(e),this.generateSelectionRings(e),this.generateOthers(e))},t.getHitObjectCache=function(e){return this.textures.hitObjects[e]||this.textures.hitObjects["#FF0000"]},t.getHeldTrailCache=function(e){return this.textures.trails[e]||this.textures.trails["#FF0000"]},t.getHeldHitObjectCache=function(e){return this.textures.heldHitObjects[e]||this.textures.heldHitObjects["#FF0000"]},t.getSelectionRingsCache=function(e){return this.textures.selectionRings[e]||this.textures.selectionRings["#FF0000"]},t.generateOthers=function(e){var t=this.sizes,n=this.colors,r=this.isHorizontal,i=new ex.K3;i.beginFill(this.colors.background_plain[1]).drawRect(0,0,this.sizes.width,this.sizes.timelineSize).lineStyle(3,this.colors.secondary[1],1).moveTo(0,t.timelineSize).lineTo(this.sizes.width,t.timelineSize);var s=e.renderer.generateTexture(i,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,this.sizes.width,this.sizes.timelineSize)});this.textures.timeline.square=s;var a=r?t.height/16:t.width/16,o=(0,Q.uZ)(t.timelineSize/4,8,100),l=new ex.K3;l.beginFill(n.accent[1]).moveTo(0,0).lineTo(o,0).lineTo(o/2,o).lineTo(0,0).moveTo(0,0).lineTo(o,0).lineTo(o/2,-o).lineTo(0,0).endFill().lineStyle(3,n.accent[1],1).moveTo(o/2,0).lineTo(o/2,t.timelineSize).lineStyle(0).beginFill(n.accent[1]).moveTo(0,t.timelineSize).lineTo(o,t.timelineSize).lineTo(o/2,t.timelineSize).lineTo(0,t.timelineSize).moveTo(0,t.timelineSize).lineTo(o,t.timelineSize).lineTo(o/2,t.timelineSize-o).lineTo(0,t.timelineSize);var c=t.timelineSize/2,u=new ex.K3;u.lineStyle(H()()?2:3,n.secondary[1],1).drawCircle(t.timelineSize/2+1,t.timelineSize/2,c/2);var d=e.renderer.generateTexture(u,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,t.timelineSize,t.timelineSize)});this.textures.timeline.note=d;var h=new ex.K3;h.lineStyle(12,n.accent[1],1).moveTo(0,0).lineTo(0,t.timelineSize);var g=e.renderer.generateTexture(h,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,12,t.timelineSize)});this.textures.timeline.currentTime=g;var m=e.renderer.generateTexture(l,{resolution:2,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,o,t.timelineSize)});this.textures.timeline.thumb=m;var f=new ex.K3;f.beginFill(n.accent[1]).moveTo(0,0).lineTo(o,0).lineTo(o/2,o).lineTo(0,0).moveTo(0,0).lineTo(o,0).lineTo(o/2,-o).lineTo(0,0);var p=e.renderer.generateTexture(f,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,o,o)});this.textures.timeline.breakpoint=p;var v=new ex.K3;if(v.beginFill(n.background_10[1]),r){v.drawRoundedRect(a/2,a/2,t.width/2-a,t.height/2-a,16);var x=e.renderer.generateTexture(v,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,t.width/2,t.height/2)});this.textures.buttons.width=t.width/2,this.textures.buttons.height=t.height/2,this.textures.buttons.time=x}else{v.drawRoundedRect(a/2,a/2,t.width/2-a,t.height/3-a,8);var b=e.renderer.generateTexture(v,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,t.width/2,t.height/3)});this.textures.buttons.width=t.width/2,this.textures.buttons.height=t.height/3,this.textures.buttons.time=b}},t.generateTrails=function(e){var t=this,n=this.sizes,r=this.trackColors,i=(0,c.Z)(r).concat(["#FF0000"]),s=(0,Q.uZ)(n.keyHeight/2*n.scaling,n.keyHeight/(H()()?3:4),100),a=s/2;i.forEach(function(n){var r=new ex.K3;t.isHorizontal?r.beginFill(ei()(n).rgbNumber()).drawRect(0,a/2,s,s-a):r.beginFill(ei()(n).rgbNumber()).drawRect(a/2,0,s-a,s);var i=e.renderer.generateTexture(r,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,s,s)});t.textures.trails[n]=i,r.destroy(!0)}),this.textures.sizes.trail=s},t.generateSelectionRings=function(e){var t=this,n=this.sizes,r=this.trackColors,i=(0,c.Z)(r).concat(["#FF0000"]),s=(0,Q.uZ)(n.keyHeight/1.5*n.scaling,n.keyHeight/(H()()?1.2:2),150);i.forEach(function(n){var r=new ex.K3;r.lineStyle(3,ei()(n).rgbNumber()).drawCircle(s/2,s/2,s/2-3);var i=e.renderer.generateTexture(r,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,s,s)});t.textures.selectionRings[n]=i,r.destroy(!0)})},t.generateTrackCache=function(e){var t=this,n=this.colors,r=this.sizes,i=this.trackColors,s=(0,Q.uZ)(r.keyHeight/1.8*r.scaling,r.keyHeight/(H()()?2:3.5),100);(0,c.Z)(i).concat(["#FF0000"]).forEach(function(r){var i=new ex.K3,a=s/2;i.lineStyle(5,ei()(r).rgbNumber()).beginFill(n.background_10[1]).drawCircle(a,a,a-5);var o=e.renderer.generateTexture(i,{resolution:2,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,s,s)});t.textures.hitObjects[r]=o,i.destroy(!0);var l=new ex.K3,c=.7*s,u=(s-c)/2;l.width=c,l.height=c,l.lineStyle(5,ei()(r).rgbNumber()).beginFill(n.background_10[1]).drawRoundedRect(u,u,c,c,6);var d=e.renderer.generateTexture(l,{resolution:2,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,s,s)});t.textures.heldHitObjects[r]=d,l.destroy(!0)}),this.textures.sizes.hitObject=s},t.generateSnapPoints=function(e){var t=this.colors,n=this.sizes,r=this.isHorizontal,i=new ex.K3,s=new ex.K3,a=new ex.K3;if(r){i.lineStyle(2,t.lineColor[1]).moveTo(0,0).lineTo(0,n.height);var o=e.renderer.generateTexture(i,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,n.snapPointWidth,n.height)});s.lineStyle(4,t.secondary[1]).moveTo(0,0).lineTo(0,n.height);var l=e.renderer.generateTexture(s,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,n.snapPointWidth,n.height)}),c=n.height/10;a.lineStyle(2,t.secondary[1]);for(var u=0;u<12;u++){var d=c*u-c;a.moveTo(X.fO,d),a.lineTo(0,d+c)}var h=e.renderer.generateTexture(a,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,X.fO,n.height)});this.textures.snapPoints.size=n.snapPointWidth,this.textures.snapPoints.small=o,this.textures.snapPoints.large=l,this.textures.snapPoints.empty=h}else{i.lineStyle(2,t.lineColor[1]).moveTo(0,n.snapPointWidth).lineTo(n.width,n.snapPointWidth);var g=e.renderer.generateTexture(i,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,n.width,n.snapPointWidth)});s.lineStyle(4,t.secondary[1]).moveTo(0,n.snapPointWidth).lineTo(n.width,n.snapPointWidth);var m=e.renderer.generateTexture(s,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,n.width,n.snapPointWidth)}),f=n.width/20;a.lineStyle(2,t.secondary[1]);for(var p=0;p<22;p++){var v=f*p-f;a.moveTo(v,X.fO),a.lineTo(v+f,0)}var x=e.renderer.generateTexture(a,{resolution:1,scaleMode:eb.aH$.LINEAR,region:new eb.AeJ(0,0,n.width,X.fO)});this.textures.snapPoints.size=n.snapPointWidth,this.textures.snapPoints.large=m,this.textures.snapPoints.empty=x,this.textures.snapPoints.small=g}i.destroy(!0),s.destroy(!0),a.destroy(!0)},e}(),ej=n(7347),ek=n.n(ej),ew=function(e=[],{testString:t,timeout:n}={},{showErrors:r}={showErrors:!1}){let[i,s]=(0,g.useState)(!1),a=JSON.stringify(e);return(0,g.useEffect)(()=>{let e=JSON.parse(a).map(({family:e,weight:r,style:i,stretch:s})=>new(ek())(e,{weight:r,style:i,stretch:s}).load(t,n));Promise.all(e).then(()=>s(!0)).catch(()=>{r&&console.error("An error occurred during font loading")})},[a,t,n,r]),i},eS=new eb.pn8({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:30,fill:"#ffffff"}),eC=[{family:"Bonobo"}],eT=(0,g.memo)(function(e){var t=e.keys,n=e.sizes,r=e.colors,i=e.isHorizontal,s=e.onKeyDown,a=e.onKeyUp,o=(0,m.Z)((0,g.useState)(eS),2),l=o[0],c=o[1],u=ew(eC);(0,g.useEffect)(function(){c(new eb.pn8({fontFamily:u?'"Bonobo"':'"Source Sans Pro", Helvetica, sans-serif',fontSize:u?25:30,fill:r.lineColor[1]}))},[r,n,t,u]);var d=n.height/t.length,f=n.width/t.length;return(0,h.jsxs)(ef.W2,{x:0,y:n.timelineSize,children:[(0,h.jsx)(ef.TC,{draw:function(e){if(e.clear(),e.beginFill(r.background_plain[1]),i){e.drawRect(0,0,60,n.height),e.lineStyle(2,r.lineColor_10[1]);for(var s=0;s<t.length-1;s++)e.moveTo(0,d*(s+1)),e.lineTo(n.width,d*(s+1));e.lineStyle(2,r.secondary[1]),e.moveTo(59,0),e.lineTo(59,n.height)}else{e.drawRect(0,n.height-60,n.width,60),e.lineStyle(2,r.lineColor_10[1]);for(var a=0;a<t.length-1;a++)e.moveTo(f*(a+1),0),e.lineTo(f*(a+1),n.height);e.lineStyle(2,r.secondary[1]),e.moveTo(0,n.height-60),e.lineTo(n.width,n.height-60)}}}),(0,h.jsx)(ef.TC,{draw:function(e){if(e.clear(),e.lineStyle(6,r.accent[1]),i){e.moveTo(X.fO+1,0),e.lineTo(X.fO+1,n.height);for(var s=0;s<t.length;s++)e.drawCircle(X.fO+1,d*(s+.5),4)}else{var a=n.height-X.fO-1-n.timelineSize;e.moveTo(0,a),e.lineTo(n.width,a);for(var o=0;o<t.length;o++)e.drawCircle(f*(o+.5)+1,a,4)}}}),t.map(function(e,t){var r=new eb.AeJ(i?0:f*t,i?d*t:n.height-60,i?60:n.width,i?d:60);return(0,h.jsx)(ef.W2,{hitArea:r,interactive:!0,pointerdown:function(){return s(t)},pointerup:function(){return a(t)},pointerupoutside:function(){return a(t)},children:(0,h.jsx)(ef.xv,{x:i?30:f*t+f/2,y:i?d*t+d/2:n.height-30,anchor:.5,text:"".concat(t+1),style:l})},e)})]})},function(e,t){return e.keys===t.keys&&e.sizes===t.sizes&&e.colors===t.colors&&e.isHorizontal===t.isHorizontal});function eH(e){var t=e.track,n=e.sizes,r=e.keys,i=e.cache,s=e.isHorizontal,a=e.selectedHitObject,o=e.selectHitObject,l=e.trackIndex,c=e.timestamp,u=n.scaling,d=n.height/r,m=n.width/r,f=c-X.fO/u-i.textures.sizes.hitObject,p=c+(s?n.width:n.height)/u-X.fO+i.textures.sizes.hitObject;return(0,h.jsx)(h.Fragment,{children:t.hitObjects.map(function(e){if(f>e.timestamp+e.holdDuration||e.timestamp>p)return null;var r=s?e.timestamp*u:m*e.index+m/2,c=s?d*e.index+d/2:-(e.timestamp*u-n.height);return e.isHeld?(0,h.jsxs)(ef.W2,{interactive:!0,pointerdown:function(t){o(e,l,(0,Q.Bq)(t.data.button))},children:[s?(0,h.jsx)(ef.jy,{texture:i.getHeldTrailCache(t.color),anchor:[0,.5],height:i.textures.sizes.trail,width:e.holdDuration*u,x:r,y:c}):(0,h.jsx)(ef.jy,{texture:i.getHeldTrailCache(t.color),anchor:X.$n,width:i.textures.sizes.trail,height:e.holdDuration*u,x:r,y:c}),(0,h.jsx)(ef.jy,{texture:i.getHeldHitObjectCache(t.color),anchor:.5,x:r,angle:45,y:c}),(0,h.jsx)(ef.jy,{texture:i.getHeldHitObjectCache(t.color),anchor:.5,x:s?(e.timestamp+e.holdDuration)*u:r,y:s?c:c-e.holdDuration*u}),e===a&&(0,h.jsx)(ef.jy,{texture:i.getSelectionRingsCache(t.color),anchor:.5,x:r,y:c})]},e.renderId):(0,h.jsxs)(g.Fragment,{children:[e===a&&(0,h.jsx)(ef.jy,{texture:i.getSelectionRingsCache(t.color),anchor:.5,x:r,y:c}),(0,h.jsx)(ef.jy,{texture:i.getHitObjectCache(t.color),interactive:!0,pointerdown:function(t){o(e,l,(0,Q.Bq)(t.data.button))},anchor:.5,x:r,y:c})]},e.renderId)})})}var eO=[{family:"Bonobo"}];function eN(e){var t=e.vsrg,n=e.sizes,r=e.snapPoint,i=e.timestamp,s=e.snapPoints,a=e.colors,o=e.cache,l=e.onSnapPointSelect,c=e.preventClick,u=e.isHorizontal,d=e.selectedHitObject,f=e.selectHitObject,p=e.onAddTime,v=e.onRemoveTime,x=function(e){if(!c){if(u){var t=e.data.global.y-n.timelineSize;l(e.target.x/b,Math.floor(t/n.keyHeight),(0,Q.Bq)(e.data.button))}else l(Math.abs(Math.floor(e.target.y-n.height+k)/b),Math.floor(e.data.global.x/n.keyWidth),(0,Q.Bq)(e.data.button))}},b=n.scaling,y=i-(X.fO+o.textures.snapPoints.size)/b,j=i+((u?n.width:n.height)-X.fO)/b,k=o.textures.snapPoints.size,w=(0,m.Z)((0,g.useState)(eS),2),S=w[0],C=w[1],T=ew(eO);return(0,g.useEffect)(function(){C(new eb.pn8({fontFamily:T?'"Bonobo"':'"Source Sans Pro", Helvetica, sans-serif',fontSize:T?25:30,fill:a.lineColor[1]}))},[T,a.lineColor]),(0,h.jsxs)(ef.W2,{x:u?-i*b+X.fO:0,y:u?n.timelineSize:i*b-X.fO,interactive:!0,interactiveChildren:!0,children:[s.map(function(e,t){return y>e||e>j?null:(0,h.jsx)(ef.jy,{interactive:!0,pointertap:x,x:u?e*b:0,y:u?0:-(e*b-n.height+k),texture:t%r?o.textures.snapPoints.small:o.textures.snapPoints.large},e)}),y<0&&(0,h.jsx)(ef.jy,{x:u?-X.fO:0,y:u?0:n.height,texture:o.textures.snapPoints.empty}),t.tracks.map(function(e,r){return(0,h.jsx)(eH,{track:e,cache:o,keys:t.keys,colors:a,sizes:n,timestamp:i,trackIndex:r,selectHitObject:f,selectedHitObject:d,isHorizontal:u},r)}),i>=t.duration-(u?n.width:n.height)/b&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(ef.W2,{pointertap:p,interactive:!0,x:u?t.duration*b:0,anchor:.5,y:u?0:-(t.duration*b-n.height+o.textures.buttons.height),children:[(0,h.jsx)(ef.jy,{texture:o.textures.buttons.time}),(0,h.jsx)(ef.xv,{x:o.textures.buttons.width/2,anchor:.5,y:o.textures.buttons.height/2,text:"Click to add time",style:S})]}),(0,h.jsxs)(ef.W2,{pointertap:v,interactive:!0,x:u?t.duration*b:n.width/2,anchor:.5,y:u?n.height/2:-(t.duration*b-n.height+o.textures.buttons.height),children:[(0,h.jsx)(ef.jy,{texture:o.textures.buttons.time}),(0,h.jsx)(ef.xv,{x:o.textures.buttons.width/2,anchor:.5,y:o.textures.buttons.height/2,text:"Click to remove time",style:S})]})]})]})}var eP=(0,g.memo)(function(e){var t=e.cache,n=e.breakpoints,r=e.sizes,i=e.duration;return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(ef.W2,{children:n.map(function(e){return(0,h.jsx)(ef.jy,{texture:t.textures.timeline.breakpoint,x:e/i*r.width},e)})})})},function(e,t){return e.breakpoints===t.breakpoints&&e.cache===t.cache&&e.sizes===t.sizes&&e.duration===t.duration}),eE=new eb.AeJ(0,0,0,0);function ez(e){var t=e.sizes,n=e.timestamp,r=e.song,i=e.cache,s=e.hidden,a=e.notes,o=e.onTimelineClick,l=(0,m.Z)((0,g.useState)(eE),2),c=l[0],u=l[1],d=(0,m.Z)((0,g.useState)(!1),2),f=d[0],p=d[1],v=n-(X.fO+t.timelineSize)/t.scaling,x=n+(t.width-X.fO+t.timelineSize)/t.scaling,b=(0,g.useCallback)(function(){return p(!1)},[]);(0,g.useEffect)(function(){u(new eb.AeJ(0,0,t.width,t.timelineSize))},[t]),(0,g.useEffect)(function(){var e=function(){p(!1)};return window.addEventListener("blur",e),function(){return window.removeEventListener("blur",e)}},[]);var y=(0,g.useCallback)(function(e,n){if(f||!0===n){var i=e.data.global.x/t.width*r.duration;o((0,Q.uZ)(i,0,r.duration))}},[t,r.duration,o,f]),j=(0,g.useCallback)(function(e){p(!0),y(e,!0)},[y]);if(s)return null;var k=n/r.duration;return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)(ef.W2,{x:0,y:0,interactive:!0,pointermove:y,pointerdown:j,pointerup:b,pointerupoutside:b,hitArea:c,children:[(0,h.jsx)(ef.jy,{x:0,y:0,width:t.width,texture:i.textures.timeline.square}),(0,h.jsx)(ef.W2,{x:-n*t.scaling+X.fO,y:0,children:a.map(function(e,n){return e.time<v||e.time>x?null:(0,h.jsx)(ef.jy,{x:e.time*t.scaling,anchor:X.Xu,texture:i.textures.timeline.note},n)})}),(0,h.jsx)(eP,{breakpoints:r.breakpoints,cache:i,sizes:t,duration:r.duration}),(0,h.jsx)(ef.jy,{x:X.fO-2,y:0,texture:i.textures.timeline.currentTime}),(0,h.jsx)(ef.jy,{y:0,x:k*t.width,texture:i.textures.timeline.thumb})]})})}var eA=function(e){(0,a.Z)(n,e);var t=(0,u.Z)(n);function n(e){var i;return(0,s.Z)(this,n),(i=t.call(this,e)).wrapperRef=(0,g.createRef)(),i.stageRef=(0,g.createRef)(),i.toDispose=[],i.throttledEventLoop=new ep.v(function(){},48),i.cumulativeScroll=0,i.handleEvent=function(e,t){"colorChange"===e&&i.generateCache(),"updateKeys"===e&&i.calculateSizes(),"updateOrientation"===e&&i.calculateSizes(),"snapPointChange"===e&&i.calculateSizes(),"tracksChange"===e&&i.generateCache(),"songLoad"===e&&i.calculateSizes(),"scaleChange"===e&&i.calculateSizes(),"maxFpsChange"===e&&i.throttledEventLoop.changeMaxFps(i.props.maxFps),"timestampChange"===e&&i.setTimestamp(t)},i.handleTick=function(e,t){if(i.props.isPlaying){var n=i.state.timestamp+t*i.props.tempoChanger;i.setTimestamp(n)}},i.handleBlur=function(){i.setState({isPressing:!1})},i.calculateSizes=function(){var e=(0,r.Z)(i).wrapperRef;if(!e.current)return console.warn("no wrapper");var t=e.current.getBoundingClientRect(),n=i.props.scaling,s=H()()?20:40,a=t.height-s,o={el:t,rawWidth:t.width,rawHeight:t.height,width:t.width,height:a,keyHeight:a/X.CB[i.props.vsrg.keys].length,keyWidth:t.width/X.CB[i.props.vsrg.keys].length,snapPointWidth:6e4/i.props.vsrg.bpm/i.props.snapPoint*n/100,scaling:n/100,timelineSize:s},l=e.current.querySelector("canvas");l&&(l.style.width="".concat(o.width,"px"),l.style.height="".concat(o.height+s,"px")),i.setState({sizes:o},i.generateCache)},i.handleWheel=function(e){if(i.props.scrollSnap){if(i.cumulativeScroll+=e.deltaY,100>Math.abs(i.cumulativeScroll))return;var t=i.props.snapPoints,n=t.findIndex(function(e){return e>i.state.timestamp}),r=(n<0?t.length:n)-1+(i.cumulativeScroll<0?-1:1);if(i.cumulativeScroll=0,r<0||r>=t.length)return;var s=t[r];return i.setTimestamp(s)}var a=Math.min(Math.max(0,i.state.timestamp+e.deltaY/1.2),i.props.vsrg.duration);i.setState({timestamp:a},function(){var t=i.state,n=t.draggedHitObject,r=t.timestamp;i.props.onTimestampChange(i.state.timestamp),n&&!(r<=0)&&i.props.dragHitObject(n.timestamp+e.deltaY/1.2)})},i.setIsDragging=function(e){var t=i.state.sizes;e.clientY-t.el.top>t.timelineSize&&i.setState({isPressing:!0,previousPosition:i.props.isHorizontal?e.clientX:-e.clientY})},i.setIsNotDragging=function(e){if(i.state.isPressing){var t=i.state.draggedHitObject;i.setState({isPressing:!1,totalMovement:0,draggedHitObject:null},function(){if(t&&i.props.releaseHitObject(),setTimeout(function(){return i.setState({preventClick:!1})},200),i.props.scrollSnap){var e=i.props.snapPoints,n=e.findIndex(function(e){return e>i.state.timestamp});if(n&&!(n<0)){var r=e[n],s=e[n-1];if(void 0!==r&&void 0!==s){var a=(0,Q.uy)(i.state.timestamp,s,r);i.setTimestamp(a)}}}})}},i.handleDrag=function(e){if(i.state.isPressing){var t=i.state,n=t.previousPosition,r=t.draggedHitObject,s=t.sizes,a=t.timestamp,o=i.props,l=o.isHorizontal,c=o.vsrg,u=l?e.clientX:-e.clientY,d=Math.floor((l?e.clientY-s.el.top-s.timelineSize:e.clientX-s.el.left)/(l?s.keyHeight:s.keyWidth)),h=(n-u)/s.scaling,g=i.state.totalMovement+Math.abs(h);if(null!==r){var m=r.timestamp-h;return i.setState({previousPosition:u},function(){return i.props.dragHitObject(Math.max(0,m),d)})}var f=Math.min(Math.max(0,a+h),c.duration);i.setState({previousPosition:u,preventClick:g>50,totalMovement:g,timestamp:f},function(){return i.props.onTimestampChange(i.state.timestamp)})}},i.generateCache=function(){var e=i.state,t=e.sizes,n=e.canvasColors,r=e.cache,s=i.props.vsrg.tracks.map(function(e){return e.color});if(i.stageRef.current){var a=new ey({app:i.stageRef.current.app,sizes:t,colors:n,trackColors:s,isHorizontal:i.props.isHorizontal});i.setState({cache:a},function(){null==r||r.destroy()})}},i.selectHitObject=function(e,t,n){2!==n&&i.setState({draggedHitObject:e}),i.props.selectHitObject(e,t,n)},i.setTimestamp=function(e){i.setState({timestamp:e}),i.props.onTimestampChange(e)},i.handleThemeChange=function(e){var t=e.get("primary"),n=e.getText("primary"),r=n.darken(.5).desaturate(1),s=t.darken(.15),a=s.darken(.1),o=e.get("secondary"),l=e.get("accent");i.setState({canvasColors:{background_plain:[t.hex(),t.rgbNumber()],background:[s.hex(),s.rgbNumber()],background_10:[a.hex(),a.rgbNumber()],secondary:[o.hex(),o.rgbNumber()],lineColor:[n.hex(),n.rgbNumber()],lineColor_10:[r.hex(),r.rgbNumber()],accent:[l.hex(),l.rgbNumber()]}},i.generateCache)},i.state={canvasColors:{background_plain:["#000000",0],background:["#000000",0],background_10:["#000000",0],secondary:["#ffffff",16777215],lineColor:["#ffffff",16777215],lineColor_10:["#ffffff",16777215],accent:["#ffffff",16777215]},timestamp:0,sizes:{el:(0,o.Z)({},X.n),rawWidth:0,rawHeight:0,width:0,height:0,snapPointWidth:0,keyHeight:0,keyWidth:0,timelineSize:0,scaling:0},draggedHitObject:null,isPressing:!1,totalMovement:0,previousPosition:0,preventClick:!1,cache:null},i.wrapperRef=(0,g.createRef)(),i.stageRef=(0,g.createRef)(),i}var i=n.prototype;return i.componentDidMount=function(){var e,t=this;this.toDispose.push((0,z.B)(this.handleThemeChange)),window.addEventListener("resize",this.calculateSizes),this.toDispose.push(function(){return window.removeEventListener("resize",t.calculateSizes)}),eu.addEventListener("ALL",{callback:this.handleEvent,id:"vsrg-canvas-color-change"}),this.toDispose.push(function(){return eu.removeEventListener("ALL",{id:"vsrg-canvas-color-change"})}),this.calculateSizes(),this.throttledEventLoop.setCallback(this.handleTick),this.throttledEventLoop.changeMaxFps(this.props.maxFps),this.throttledEventLoop.start(),window.addEventListener("blur",this.handleBlur),null===(e=this.state.cache)||void 0===e||e.destroy(),this.toDispose.push(function(){return window.removeEventListener("blur",t.handleBlur)}),this.handleThemeChange(ev.f6)},i.componentWillUnmount=function(){var e;this.toDispose.forEach(function(e){return e()}),null===(e=this.state.cache)||void 0===e||e.destroy(),this.throttledEventLoop.stop()},i.render=function(){var e=this.state,t=e.canvasColors,n=e.sizes,r=e.cache,i=e.timestamp,s=e.preventClick,a=this.props,o=a.vsrg,l=a.isHorizontal,c=a.audioSong,u=a.snapPoint,d=a.snapPoints,g=a.selectedHitObject;return(0,h.jsx)("div",{className:"vsrg-top-canvas-wrapper",ref:this.wrapperRef,children:this.wrapperRef.current&&(0,h.jsxs)(ef.Hf,{onMount:this.calculateSizes,ref:this.stageRef,raf:!1,width:n.rawWidth,height:n.rawHeight,onWheel:this.handleWheel,onPointerDown:this.setIsDragging,onPointerUp:this.setIsNotDragging,onPointerLeave:this.setIsNotDragging,onPointerMove:this.handleDrag,onContextMenu:function(e){return e.preventDefault()},options:{backgroundColor:t.background[1],autoDensity:!1,resolution:(null==window?void 0:window.devicePixelRatio)||1},children:[r&&(0,h.jsx)(eN,{vsrg:o,cache:r,selectedHitObject:g,snapPoint:u,snapPoints:d,timestamp:i,preventClick:s,sizes:n,colors:t,isHorizontal:l,onAddTime:this.props.onAddTime,onRemoveTime:this.props.onRemoveTime,selectHitObject:this.selectHitObject,onSnapPointSelect:this.props.onSnapPointSelect}),(0,h.jsx)(eT,{isHorizontal:l,keys:X.CB[o.keys],sizes:n,colors:t,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp}),r&&(0,h.jsx)(ez,{hidden:!1,notes:this.props.renderableNotes,cache:r,timestamp:i,onTimelineClick:this.setTimestamp,isHorizontal:l,song:o,audioSong:c,sizes:n,colors:t})]})})},n}(g.Component),e_=n(5684),eL=n(1185),eR=n(1328),eM=n(2881),eZ=n(8778),eI=n(3975),eD=n(4995),eF=n(6880),eB=n(1163),eW=function(e){(0,a.Z)(n,e);var t=(0,u.Z)(n);function n(e){(0,s.Z)(this,n),(g=t.call(this,e)).lastTimestamp=0,g.changes=0,g.playbackTimestamp=0,g.mounted=!1,g.heldKeys=[],g.pressedDownHitObjects=[],g.unblock=function(){},g.addTrack=function(){var e=g.state.vsrg;e.addTrack(),g.setState({vsrg:e},function(){return eu.emitEvent("tracksChange")})},g.updateSettings=function(e){e_.j.updateVsrgComposerSettings(void 0!==e?e:g.state.settings)},g.syncInstruments=function(){var e=g.state,t=e.vsrg;e.audioPlayer.syncInstruments(t.tracks.map(function(e){return e.instrument}))},g.syncAudioSongInstruments=function(){var e=g.state,t=e.audioSong,n=e.audioPlaybackPlayer;null!==t&&(n.syncInstruments(t.instruments),n.basePitch=t.pitch)},g.handleKeyboardDown=function(e){var t,n=e.event,r=e.letter,i=e.shift,s=g.state.vsrg;if(!i){var a=null===(t=X.CB[s.keys])||void 0===t?void 0:t.indexOf(r);if(a>=0){if(n.repeat)return;g.startHitObjectTap(a)}}},g.handleKeyboardUp=function(e){var t,n=e.letter,r=g.state.vsrg,i=null===(t=X.CB[r.keys])||void 0===t?void 0:t.indexOf(n);i>=0&&g.endHitObjectTap(i)},g.startHitObjectTap=function(e){var t=g.state,n=t.vsrg,r=t.selectedTrack,i=t.selectedType;g.heldKeys[e]=!0,g.changes++;var s=g.findClosestSnapPoint(g.lastTimestamp);if("delete"===i)return n.removeHitObjectInTrackAtTimestamp(r,s,e),g.setState({vsrg:n,selectedHitObject:null});var a=n.createHitObjectInTrack(r,s,e);g.pressedDownHitObjects[e]=a,g.setState({vsrg:n,selectedHitObject:a})},g.endHitObjectTap=function(e){var t=g.state,n=t.vsrg,r=t.selectedTrack,i=g.pressedDownHitObjects[e];if(g.heldKeys[e]&&i){var s=g.findClosestSnapPoint(i.timestamp+i.holdDuration);n.setHeldHitObjectTail(r,i,s-i.timestamp)}g.heldKeys[e]=!1,g.pressedDownHitObjects[e]=void 0},g.handleSettingChange=function(e){var t=g.state,n=t.settings,r=t.vsrg,i=e.data;n[e.key]=(0,l.Z)((0,o.Z)({},n[e.key]),{value:i.value}),"keys"===e.key&&r.changeKeys(i.value),"bpm"===e.key&&(r.set({bpm:i.value}),g.calculateSnapPoints()),"difficulty"===e.key&&r.set({difficulty:i.value}),g.setState({settings:(0,o.Z)({},n)},function(){g.updateSettings(),"keys"===e.key&&eu.emitEvent("updateKeys"),"isVertical"===e.key&&eu.emitEvent("updateOrientation"),"maxFps"===e.key&&eu.emitEvent("maxFpsChange")})};var a,u,h,g,m=(0,r.Z)(g);g.changePage=(a=(0,i.Z)(function(e){var t,n,r,i;return(0,d.__generator)(this,function(s){switch(s.label){case 0:if(n=(t=m.state).vsrg,r=t.settings,"Home"===e)return[2,R.I.open()];if(!(0!==m.changes))return[3,5];if(!r.autosave.value)return[3,2];return[4,m.saveSong()];case 1:return s.sent(),[3,5];case 2:return[4,(0,j.jH)('You have unsaved changes to the song: "'.concat(n.name,'" do you want to save? UNSAVED CHANGES WILL BE LOST'),!1)];case 3:if(null===(i=s.sent()))return[2];if(!i)return[3,5];return[4,m.saveSong()];case 4:s.sent(),s.label=5;case 5:return m.props.router.events.off("routeChangeStart",m.unblock),m.props.router.push(e),[2]}})}),function(e){return a.apply(this,arguments)}),g.onSnapPointChange=function(e){var t=g.state.vsrg;t.set({snapPoint:e}),g.setState({snapPoint:e,vsrg:t},function(){g.calculateSnapPoints(),eu.emitEvent("snapPointChange")})},g.selectHitObject=function(e,t,n){var r=e.isHeld?"hold":"tap";if("delete"===g.state.selectedType||n===eI.u.Right){g.state.vsrg.removeHitObjectInTrack(t,e),g.setState({selectedHitObject:null,vsrg:g.state.vsrg});return}"hold"===g.state.selectedType&&n===eI.u.Left&&g.setState({selectedHitObject:e,lastCreatedHitObject:e,selectedType:r}),g.setState({selectedHitObject:e,selectedTrack:t,selectedType:r})},g.onSnapPointSelect=function(e,t,n){var r=g.state,i=r.vsrg,s=r.selectedType,a=r.lastCreatedHitObject,o=r.selectedTrack;if(r.selectedHitObject,g.changes++,e<0)return console.warn("Timestamp is less than 0");var l=i.getHitObjectsAt(e,t).find(function(e){return null!==e});if(n===eI.u.Unknown&&console.warn("unknown click type"),"tap"===s&&n===eI.u.Left){if(l)return g.setState({selectedHitObject:l});var c=i.createHitObjectInTrack(o,e,t);g.playHitObject(c,o),g.setState({selectedHitObject:c})}if("hold"===s&&n===eI.u.Left){if(null!==a)i.setHeldHitObjectTail(o,a,e-a.timestamp),g.setState({lastCreatedHitObject:null,selectedHitObject:null});else{if(l)return g.setState({selectedHitObject:l});var u=i.createHeldHitObject(o,e,t);g.setState({lastCreatedHitObject:u,selectedHitObject:u})}}("delete"===s||n===eI.u.Right)&&(i.removeHitObjectInTrackAtTimestamp(o,e,t),g.setState({selectedHitObject:null})),g.setState({vsrg:i})},g.selectTrack=function(e){g.setState({selectedTrack:e})},g.setAudioSong=function(e){var t=g.state.vsrg;if(g.changes++,null===e)return t.setAudioSong(null),g.setState({audioSong:null,renderableNotes:[]});var n=_.v.parseSong(e);if(n instanceof eM.M){t.setAudioSong(n),n.startPlayback(g.lastTimestamp),t.setDurationFromNotes(n.notes);var r=t.getRenderableNotes(n);g.setState({audioSong:n,renderableNotes:r},function(){g.syncAudioSongInstruments(),g.calculateSnapPoints()})}if(n instanceof eZ.l){var i=n.toRecordedSong(0);t.setDurationFromNotes(i.notes),i.startPlayback(g.lastTimestamp),t.setAudioSong(n);var s=t.getRenderableNotes(i);g.setState({audioSong:i,renderableNotes:s},function(){g.syncAudioSongInstruments(),g.calculateSnapPoints()})}};var f=(0,r.Z)(g);g.askForSongUpdate=(0,i.Z)(function(){return(0,d.__generator)(this,function(e){switch(e.label){case 0:return[4,(0,j.jH)('You have unsaved changes to the song: "'.concat(f.state.vsrg.name,'" do you want to save now?'),!1)];case 1:return[2,e.sent()]}})});var p=(0,r.Z)(g);g.createNewSong=(0,i.Z)(function(){var e,t,n,r;return(0,d.__generator)(this,function(i){switch(i.label){case 0:if(!("Untitled"!==p.state.vsrg.name&&p.changes>0))return[3,3];return[4,p.askForSongUpdate()];case 1:if(null===(e=i.sent()))return[2];if(!e)return[3,3];return[4,p.saveSong()];case 2:i.sent(),i.label=3;case 3:return[4,(0,j.cJ)("Enter song name")];case 4:if(!(t=i.sent()))return[3,6];return(n=new em.Cz(t)).set({bpm:p.state.settings.bpm.value,keys:p.state.settings.keys.value,pitch:p.state.settings.pitch.value,snapPoint:p.state.snapPoint}),n.addTrack(),[4,M.k.addSong(n)];case 5:r=i.sent(),n.set({id:r}),p.setState({vsrg:n,renderableNotes:[]},function(){eu.emitEvent("songLoad"),p.calculateSnapPoints(),p.syncInstruments()}),i.label=6;case 6:return[2]}})}),g.calculateSnapPoints=function(){var e=g.state,t=e.vsrg,n=e.snapPoint,r=t.duration/Math.floor(6e4/t.bpm)*n,i=t.duration/r,s=Array(Math.floor(r)).fill(0).map(function(e,t){return t*i});g.setState({snapPoints:s,snapPointDuration:i})},g.dragHitObject=function(e,t){var n=g.state,r=n.selectedHitObject,i=n.vsrg,s=n.settings;null!==r&&(r.timestamp=e,void 0!==t&&t<s.keys.value&&(r.index=t),g.setState({vsrg:i,selectedHitObject:r}))},g.findClosestSnapPoint=function(e){return g.state.snapPoints.reduce(function(t,n){return Math.abs(n-e)<Math.abs(t-e)?n:t})},g.releaseHitObject=function(){var e=g.state,t=e.selectedHitObject,n=e.vsrg;null!==t&&(t.timestamp=g.findClosestSnapPoint(t.timestamp),n.getHitObjectsBetween(t.timestamp,t.timestamp+t.holdDuration,t.index).forEach(function(e,r){return e.forEach(function(e){return e!==t&&n.removeHitObjectInTrackAtTimestamp(r,e.timestamp,e.index)})}),g.changes++,g.setState({vsrg:n}))},g.onTrackChange=function(e,t){var n=g.state.vsrg;n.tracks[t]=e,g.setState({vsrg:n},g.syncInstruments)},g.onNoteSelect=function(e){var t=g.state,n=t.selectedHitObject,r=t.audioPlayer,i=t.selectedTrack;null==n||n.toggleNote(e),r.playNoteOfInstrument(i,e),g.setState({selectedHitObject:n})},g.togglePlay=function(){var e=g.state,t=e.isPlaying,n=e.vsrg,r=e.audioSong;if(n.startPlayback(g.lastTimestamp),g.lastTimestamp>=n.duration)return g.setState({isPlaying:!1});r&&r.startPlayback(g.lastTimestamp),g.setState({isPlaying:!t})},g.playHitObject=function(e,t){g.state.audioPlayer.playNotesOfInstrument(t,e.notes)},g.onTimestampChange=function(e){var t=g.state,n=t.vsrg,r=t.isPlaying,i=t.audioSong,s=t.audioPlaybackPlayer,a=t.snapPointDuration;if(g.lastTimestamp=e,r){if(g.lastTimestamp>=n.duration)return g.setState({isPlaying:!1});g.heldKeys.forEach(function(t,n){if(t){var r=g.pressedDownHitObjects[n];if(r){var i=e-r.timestamp;i>a&&(r.holdDuration=i,r.isHeld=!0)}}}),i&&i.tickPlayback(e).forEach(function(e){e.layer.toArray().forEach(function(t,r){0===t||n.trackModifiers[r].muted||s.playNoteOfInstrument(r,e.index)})}),n.tickPlayback(e).forEach(function(e,t){return e.forEach(function(e){return g.playHitObject(e,t)})})}};var v=(0,r.Z)(g);g.deleteTrack=(u=(0,i.Z)(function(e){var t;return(0,d.__generator)(this,function(n){switch(n.label){case 0:if(1===(t=v.state.vsrg).tracks.length)return[2,J.kg.error("Cannot delete last track")];return[4,(0,j.jH)("Are you sure you want to remove this track? All notes will be deleted.")];case 1:if(!n.sent()||!v.mounted)return[2];return v.changes++,t.deleteTrack(e),v.setState({vsrg:t,selectedTrack:Math.max(0,e-1)},function(){return eu.emitEvent("tracksChange")}),[2]}})}),function(e){return u.apply(this,arguments)});var x=(0,r.Z)(g);g.onSongOpen=(h=(0,i.Z)(function(e){var t,n,r,s,a;return(0,d.__generator)(this,function(c){switch(c.label){case 0:if(n=(t=x.state).settings,r=t.vsrg,!(0!==x.changes))return[3,4];if(s=n.autosave.value&&"Untitled"!==r.name)return[3,2];return[4,(0,j.jH)('You have unsaved changes to the song: "'.concat(r.name,'" do you want to save? UNSAVED CHANGES WILL BE LOST'),!1)];case 1:if(null===(a=c.sent()))return[2];s=a,c.label=2;case 2:if(!s)return[3,4];return[4,x.saveSong()];case 3:c.sent(),c.label=4;case 4:return n.bpm=(0,l.Z)((0,o.Z)({},n.bpm),{value:e.bpm}),n.keys=(0,l.Z)((0,o.Z)({},n.keys),{value:e.keys}),n.pitch=(0,l.Z)((0,o.Z)({},n.pitch),{value:e.pitch}),x.updateSettings(),x.changes++,x.setState({vsrg:e,snapPoint:e.snapPoint,selectedTrack:0,selectedHitObject:null,lastCreatedHitObject:null},(0,i.Z)(function(){var t;return(0,d.__generator)(this,function(n){switch(n.label){case 0:return eu.emitEvent("songLoad"),x.syncInstruments(),[4,M.k.getSongById(e.audioSongId)];case 1:return t=n.sent(),x.setAudioSong(t),x.calculateSnapPoints(),[2]}})})),[2]}})}),function(e){return h.apply(this,arguments)}),g.addTime=function(){var e=g.state.vsrg;e.duration+=1e3,g.calculateSnapPoints(),g.changes++,g.setState({vsrg:e})},g.removeTime=function(){var e=g.state.vsrg;e.duration-=1e3,g.calculateSnapPoints(),g.changes++,g.setState({vsrg:e})},g.onScalingChange=function(e){g.setState({scaling:e},function(){return eu.emitEvent("scaleChange")})};var b=(0,r.Z)(g);g.saveSong=(0,i.Z)(function(){var e,t,n,r;return(0,d.__generator)(this,function(i){switch(i.label){case 0:if(!(null!==(e=b.state.vsrg).id))return[3,1];return n=e.name,[3,3];case 1:return[4,(0,j.cJ)("Enter song name")];case 2:n=i.sent(),i.label=3;case 3:if(null===(t=n))return[2];if(e.set({name:t}),null!==e.id)return[3,5];return[4,M.k.addSong(e)];case 4:return r=i.sent(),e.set({id:r}),[3,6];case 5:M.k.updateSong(e),i.label=6;case 6:return b.changes=0,b.setState({vsrg:e}),[2]}})}),g.onTrackModifierChange=function(e,t,n){var r=g.state,i=r.vsrg,s=r.audioSong;if(i.trackModifiers[t]=e,i.trackModifiers=(0,c.Z)(i.trackModifiers),g.changes++,n&&s){var a=i.getRenderableNotes(s);return g.setState({renderableNotes:a,vsrg:i})}g.setState({vsrg:i})},g.onTempoChangerChange=function(e){g.setState({tempoChanger:e})},g.selectType=function(e){g.setState({selectedType:e,lastCreatedHitObject:null})},g.onBreakpointChange=function(e){var t=g.state.vsrg,n=g.findClosestSnapPoint(g.lastTimestamp);t.setBreakpoint(n,!e),g.setState({vsrg:t})},g.onBreakpointSelect=function(e){var t=g.state,n=t.vsrg,r=t.isPlaying,i=t.audioSong,s=n.getClosestBreakpoint(g.lastTimestamp,e);r&&(null==i||i.startPlayback(s),n.startPlayback(s)),eu.emitEvent("timestampChange",s)};var y=e_.j.getDefaultVsrgComposerSettings();return g.state={vsrg:new em.Cz("Untitled"),audioPlayer:new eL.z(y.pitch.value),audioPlaybackPlayer:new eL.z(y.pitch.value),selectedTrack:0,snapPoint:1,snapPoints:[0],snapPointDuration:0,selectedHitObject:null,scaling:60,selectedType:"tap",isPlaying:!1,lastCreatedHitObject:null,settings:y,audioSong:null,renderableNotes:[],tempoChanger:1},g.state.vsrg.addTrack("DunDun"),g.state.vsrg.set({bpm:y.bpm.value,keys:y.keys.value}),g.mounted=!1,g}var g=n.prototype;return g.componentDidMount=function(){var e=this,t=e_.j.getVsrgComposerSettings();this.setState({settings:t}),this.state.audioPlayer.setBasePitch(t.pitch.value),this.state.audioPlaybackPlayer.setBasePitch(t.pitch.value),this.mounted=!0;var n="vsrg-composer";this.calculateSnapPoints(),this.syncInstruments(),this.unblock=function(t){if(0!==e.changes)throw e.changePage(t),e.props.router.events.emit("routeChangeError"),"routeChange aborted.";e.props.router.events.off("routeChangeStart",e.unblock),e.props.router.push(t)},this.props.router.events.on("routeChangeStart",this.unblock),eR.w.listen(this.handleKeyboardDown,{id:n,type:"keydown"}),eR.w.registerNumber(1,function(){e.setState({selectedType:"tap"})},{id:n}),eR.w.registerLetter("W",function(){var t=e.state,n=t.selectedHitObject,r=t.vsrg,i=t.snapPointDuration;n&&(e.state.settings.isVertical.value?n.timestamp=n.timestamp+i:n.index=(0,Q.uZ)(n.index-1,0,r.keys),e.releaseHitObject())},{id:n,shift:!0}),eR.w.registerLetter("A",function(){var t=e.state,n=t.selectedHitObject,r=t.vsrg,i=t.snapPointDuration;n&&(e.state.settings.isVertical.value?n.index=(0,Q.uZ)(n.index-1,0,r.keys):n.timestamp=n.timestamp-i,e.releaseHitObject())},{id:n,shift:!0}),eR.w.registerLetter("S",function(){var t=e.state,n=t.selectedHitObject,r=t.vsrg,i=t.snapPointDuration;n&&(e.state.settings.isVertical.value?n.timestamp=n.timestamp-i:n.index=(0,Q.uZ)(n.index+1,0,r.keys),e.releaseHitObject())},{id:n,shift:!0}),eR.w.registerLetter("D",function(){var t=e.state,n=t.selectedHitObject,r=t.vsrg,i=t.snapPointDuration;n&&(e.state.settings.isVertical.value?n.index=(0,Q.uZ)(n.index+1,0,r.keys):n.timestamp=n.timestamp+i,e.releaseHitObject())},{id:n,shift:!0}),eR.w.register("Escape",function(){e.setState({selectedHitObject:null,lastCreatedHitObject:null})},{id:n}),eR.w.register("Backspace",function(){var t=e.state,n=t.selectedHitObject,r=t.vsrg,i=t.selectedTrack;n&&(r.removeHitObjectInTrackAtTimestamp(i,n.timestamp,n.index),e.setState({selectedHitObject:null,lastCreatedHitObject:null}))}),eR.w.registerNumber(2,function(){e.setState({selectedType:"hold"})},{id:n}),eR.w.registerNumber(3,function(){e.setState({selectedType:"delete"})},{id:n}),eR.w.register("ArrowLeft",function(){e.onBreakpointSelect(-1)},{id:n}),eR.w.register("ArrowRight",function(){e.onBreakpointSelect(1)},{id:n}),eR.w.register("ArrowUp",function(){e.selectTrack(Math.max(0,e.state.selectedTrack-1))},{id:n}),eR.w.register("ArrowDown",function(){e.selectTrack(Math.min(e.state.vsrg.tracks.length-1,e.state.selectedTrack+1))},{id:n}),eR.w.listen(this.handleKeyboardUp,{id:n,type:"keyup"}),eR.w.register("Space",function(t){var n;t.event.repeat||((0,Q.EB)(document.activeElement)&&(null===(n=document.activeElement)||void 0===n||n.blur()),e.togglePlay())},{id:"vsrg-composer"})},g.componentWillUnmount=function(){this.mounted=!1,eR.w.unregisterById("vsrg-composer"),this.props.router.events.off("routeChangeStart",this.unblock);var e=this.state,t=e.audioPlaybackPlayer,n=e.audioPlayer;t.destroy(),n.destroy()},g.render=function(){var e,t=this.state,n=t.settings,r=t.selectedTrack,i=t.vsrg,s=t.lastCreatedHitObject,a=t.snapPoints,o=t.isPlaying,l=t.snapPoint,c=t.selectedHitObject,u=t.selectedType,d=t.audioSong,g=t.scaling,m=t.renderableNotes,f=t.tempoChanger;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(eD.D,{text:"Vsrg Composer - ".concat(null!==(e=i.name)&&void 0!==e?e:"Unnamed")}),(0,h.jsx)(V,{trackModifiers:i.trackModifiers,hasChanges:this.changes>0,settings:n,audioSong:d,onTrackModifierChange:this.onTrackModifierChange,onSongOpen:this.onSongOpen,onSave:this.saveSong,onCreateSong:this.createNewSong,setAudioSong:this.setAudioSong,handleSettingChange:this.handleSettingChange}),(0,h.jsxs)("div",{className:"vsrg-page",children:[(0,h.jsx)(eh,{vsrg:i,onBreakpointSelect:this.onBreakpointSelect,onBreakpointChange:this.onBreakpointChange,selectedHitObject:c,isHorizontal:!n.isVertical.value,selectedTrack:r,lastCreatedHitObject:s,onTrackAdd:this.addTrack,onTrackChange:this.onTrackChange,onTrackDelete:this.deleteTrack,onTrackSelect:this.selectTrack,onNoteSelect:this.onNoteSelect,children:(0,h.jsx)(eA,{vsrg:i,renderableNotes:m,onTimestampChange:this.onTimestampChange,selectedHitObject:c,isHorizontal:!n.isVertical.value,tempoChanger:f,scrollSnap:n.scrollSnap.value,maxFps:n.maxFps.value,scaling:g,audioSong:d,snapPoint:l,snapPoints:a,isPlaying:o,onRemoveTime:this.removeTime,onAddTime:this.addTime,onKeyDown:this.startHitObjectTap,onKeyUp:this.endHitObjectTap,dragHitObject:this.dragHitObject,releaseHitObject:this.releaseHitObject,selectHitObject:this.selectHitObject,onSnapPointSelect:this.onSnapPointSelect})}),(0,h.jsx)(en,{vsrg:i,scaling:g,tempoChanger:f,onTempoChangerChange:this.onTempoChangerChange,onScalingChange:this.onScalingChange,isPlaying:o,togglePlay:this.togglePlay,selectedSnapPoint:l,onSnapPointChange:this.onSnapPointChange,selectedHitObjectType:u,onHitObjectTypeChange:this.selectType})]})]})},n}(g.Component);function eK(){var e=(0,eB.useRouter)();return(0,h.jsx)(eW,{router:e})}eK.getLayout=function(e){return(0,h.jsx)(eF.Z,{page:"Composer",children:e})}},5651:function(e,t,n){"use strict";n.d(t,{L_:function(){return F},ZE:function(){return J},gW:function(){return M}});var r=n(7294);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function s(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)t.indexOf(n=s[r])>=0||(i[n]=e[n]);return i}function a(e){var t=(0,r.useRef)(e),n=(0,r.useRef)(function(e){t.current&&t.current(e)});return t.current=e,n.current}var o=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),e>n?n:e<t?t:e},l=function(e){return"touches"in e},c=function(e){return e&&e.ownerDocument.defaultView||self},u=function(e,t,n){var r=e.getBoundingClientRect(),i=l(t)?function(e,t){for(var n=0;n<e.length;n++)if(e[n].identifier===t)return e[n];return e[0]}(t.touches,n):t;return{left:o((i.pageX-(r.left+c(e).pageXOffset))/r.width),top:o((i.pageY-(r.top+c(e).pageYOffset))/r.height)}},d=function(e){l(e)||e.preventDefault()},h=r.memo(function(e){var t=e.onMove,n=e.onKey,o=s(e,["onMove","onKey"]),h=(0,r.useRef)(null),g=a(t),m=a(n),f=(0,r.useRef)(null),p=(0,r.useRef)(!1),v=(0,r.useMemo)(function(){var e=function(e){d(e),(l(e)?e.touches.length>0:e.buttons>0)&&h.current?g(u(h.current,e,f.current)):n(!1)},t=function(){return n(!1)};function n(n){var r=p.current,i=c(h.current),s=n?i.addEventListener:i.removeEventListener;s(r?"touchmove":"mousemove",e),s(r?"touchend":"mouseup",t)}return[function(e){var t=e.nativeEvent,r=h.current;if(r&&(d(t),(!p.current||l(t))&&r)){if(l(t)){p.current=!0;var i=t.changedTouches||[];i.length&&(f.current=i[0].identifier)}r.focus(),g(u(r,t,f.current)),n(!0)}},function(e){var t=e.which||e.keyCode;t<37||t>40||(e.preventDefault(),m({left:39===t?.05:37===t?-.05:0,top:40===t?.05:38===t?-.05:0}))},n]},[m,g]),x=v[0],b=v[1],y=v[2];return(0,r.useEffect)(function(){return y},[y]),r.createElement("div",i({},o,{onTouchStart:x,onMouseDown:x,className:"react-colorful__interactive",ref:h,onKeyDown:b,tabIndex:0,role:"slider"}))}),g=function(e){return e.filter(Boolean).join(" ")},m=function(e){var t=e.color,n=e.left,i=e.top,s=g(["react-colorful__pointer",e.className]);return r.createElement("div",{className:s,style:{top:100*(void 0===i?.5:i)+"%",left:100*n+"%"}},r.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:t}}))},f=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=Math.pow(10,t)),Math.round(n*e)/n},p=function(e){return C(v(e))},v=function(e){return"#"===e[0]&&(e=e.substring(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?f(parseInt(e[3]+e[3],16)/255,2):1}:{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16),a:8===e.length?f(parseInt(e.substring(6,8),16)/255,2):1}},x=function(e){return S(k(e))},b=function(e){var t=e.s,n=e.v,r=e.a,i=(200-t)*n/100;return{h:f(e.h),s:f(i>0&&i<200?t*n/100/(i<=100?i:200-i)*100:0),l:f(i/2),a:f(r,2)}},y=function(e){var t=b(e);return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},j=function(e){var t=b(e);return"hsla("+t.h+", "+t.s+"%, "+t.l+"%, "+t.a+")"},k=function(e){var t=e.h,n=e.s,r=e.v,i=e.a;t=t/360*6,n/=100,r/=100;var s=Math.floor(t),a=r*(1-n),o=r*(1-(t-s)*n),l=r*(1-(1-t+s)*n),c=s%6;return{r:f(255*[r,o,a,a,l,r][c]),g:f(255*[l,r,r,o,a,a][c]),b:f(255*[a,a,l,r,r,o][c]),a:f(i,2)}},w=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},S=function(e){var t=e.r,n=e.g,r=e.b,i=e.a,s=i<1?w(f(255*i)):"";return"#"+w(t)+w(n)+w(r)+s},C=function(e){var t=e.r,n=e.g,r=e.b,i=e.a,s=Math.max(t,n,r),a=s-Math.min(t,n,r),o=a?s===t?(n-r)/a:s===n?2+(r-t)/a:4+(t-n)/a:0;return{h:f(60*(o<0?o+6:o)),s:f(s?a/s*100:0),v:f(s/255*100),a:i}},T=r.memo(function(e){var t=e.hue,n=e.onChange,i=g(["react-colorful__hue",e.className]);return r.createElement("div",{className:i},r.createElement(h,{onMove:function(e){n({h:360*e.left})},onKey:function(e){n({h:o(t+360*e.left,0,360)})},"aria-label":"Hue","aria-valuenow":f(t),"aria-valuemax":"360","aria-valuemin":"0"},r.createElement(m,{className:"react-colorful__hue-pointer",left:t/360,color:y({h:t,s:100,v:100,a:1})})))}),H=r.memo(function(e){var t=e.hsva,n=e.onChange,i={backgroundColor:y({h:t.h,s:100,v:100,a:1})};return r.createElement("div",{className:"react-colorful__saturation",style:i},r.createElement(h,{onMove:function(e){n({s:100*e.left,v:100-100*e.top})},onKey:function(e){n({s:o(t.s+100*e.left,0,100),v:o(t.v-100*e.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+f(t.s)+"%, Brightness "+f(t.v)+"%"},r.createElement(m,{className:"react-colorful__saturation-pointer",top:1-t.v/100,left:t.s/100,color:y(t)})))}),O=function(e,t){if(e===t)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0},N=function(e,t){return e.toLowerCase()===t.toLowerCase()||O(v(e),v(t))};function P(e,t,n){var i=a(n),s=(0,r.useState)(function(){return e.toHsva(t)}),o=s[0],l=s[1],c=(0,r.useRef)({color:t,hsva:o});return(0,r.useEffect)(function(){if(!e.equal(t,c.current.color)){var n=e.toHsva(t);c.current={hsva:n,color:t},l(n)}},[t,e]),(0,r.useEffect)(function(){var t;O(o,c.current.hsva)||e.equal(t=e.fromHsva(o),c.current.color)||(c.current={hsva:o,color:t},i(t))},[o,e,i]),[o,(0,r.useCallback)(function(e){l(function(t){return Object.assign({},t,e)})},[])]}var E,z="undefined"!=typeof window?r.useLayoutEffect:r.useEffect,A=new Map,_=function(e){z(function(){var t=e.current?e.current.ownerDocument:document;if(void 0!==t&&!A.has(t)){var r=t.createElement("style");r.innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}',A.set(t,r);var i=E||n.nc;i&&r.setAttribute("nonce",i),t.head.appendChild(r)}},[])},L=function(e){var t=e.className,n=e.colorModel,a=e.color,o=void 0===a?n.defaultColor:a,l=e.onChange,c=s(e,["className","colorModel","color","onChange"]),u=(0,r.useRef)(null);_(u);var d=P(n,o,l),h=d[0],m=d[1],f=g(["react-colorful",t]);return r.createElement("div",i({},c,{ref:u,className:f}),r.createElement(H,{hsva:h,onChange:m}),r.createElement(T,{hue:h.h,onChange:m,className:"react-colorful__last-control"}))},R={defaultColor:"000",toHsva:p,fromHsva:function(e){return x({h:e.h,s:e.s,v:e.v,a:1})},equal:N},M=function(e){return r.createElement(L,i({},e,{colorModel:R}))},Z=function(e){var t=e.className,n=e.hsva,i=e.onChange,s={backgroundImage:"linear-gradient(90deg, "+j(Object.assign({},n,{a:0}))+", "+j(Object.assign({},n,{a:1}))+")"},a=g(["react-colorful__alpha",t]),l=f(100*n.a);return r.createElement("div",{className:a},r.createElement("div",{className:"react-colorful__alpha-gradient",style:s}),r.createElement(h,{onMove:function(e){i({a:e.left})},onKey:function(e){i({a:o(n.a+e.left)})},"aria-label":"Alpha","aria-valuetext":l+"%","aria-valuenow":l,"aria-valuemin":"0","aria-valuemax":"100"},r.createElement(m,{className:"react-colorful__alpha-pointer",left:n.a,color:j(n)})))},I=function(e){var t=e.className,n=e.colorModel,a=e.color,o=void 0===a?n.defaultColor:a,l=e.onChange,c=s(e,["className","colorModel","color","onChange"]),u=(0,r.useRef)(null);_(u);var d=P(n,o,l),h=d[0],m=d[1],f=g(["react-colorful",t]);return r.createElement("div",i({},c,{ref:u,className:f}),r.createElement(H,{hsva:h,onChange:m}),r.createElement(T,{hue:h.h,onChange:m}),r.createElement(Z,{hsva:h,onChange:m,className:"react-colorful__last-control"}))},D={defaultColor:"0001",toHsva:p,fromHsva:x,equal:N},F=function(e){return r.createElement(I,i({},e,{colorModel:D}))},B=/^#?([0-9A-F]{3,8})$/i,W=function(e){var t=e.color,n=void 0===t?"":t,o=e.onChange,l=e.onBlur,c=e.escape,u=e.validate,d=e.format,h=e.process,g=s(e,["color","onChange","onBlur","escape","validate","format","process"]),m=(0,r.useState)(function(){return c(n)}),f=m[0],p=m[1],v=a(o),x=a(l),b=(0,r.useCallback)(function(e){var t=c(e.target.value);p(t),u(t)&&v(h?h(t):t)},[c,h,u,v]),y=(0,r.useCallback)(function(e){u(e.target.value)||p(c(n)),x(e)},[n,c,u,x]);return(0,r.useEffect)(function(){p(c(n))},[n,c]),r.createElement("input",i({},g,{value:d?d(f):f,spellCheck:"false",onChange:b,onBlur:y}))},K=function(e){return"#"+e},J=function(e){var t=e.prefixed,n=e.alpha,a=s(e,["prefixed","alpha"]),o=(0,r.useCallback)(function(e){return e.replace(/([^0-9A-F]+)/gi,"").substring(0,n?8:6)},[n]),l=(0,r.useCallback)(function(e){var t,r;return 3===(r=(t=B.exec(e))?t[1].length:0)||6===r||!!n&&4===r||!!n&&8===r},[n]);return r.createElement(W,i({},a,{escape:o,format:t?K:void 0,process:K,validate:l}))}}},function(e){e.O(0,[228,749,962,826,26,774,888,179],function(){return e(e.s=120)}),_N_E=e.O()}]);